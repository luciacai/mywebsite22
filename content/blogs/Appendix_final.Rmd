---
categories:  
- ""    #the front matter should be like the one found in, e.g., blog2.md. It cannot be like the normal Rmd we used
- ""
date: "2022-05-10"
description: Multivariate Analysis (MANOVA) of NBA Players’ Performance # the title that will show up once someone gets to this page
draft: false
image: nba.jpeg # save picture in \static\img\blogs. Acceptable formats= jpg, jpeg, or png . Your iPhone pics wont work

keywords: ""
slug: nba # slug is the shorthand URL address... no spaces plz
title: Multivariate Analysis of NBA Players’ Performance
---

```{r}
library(dplyr)
library(tidyverse)
library(ggpubr)
library(rstatix)
library(car)
library(broom)
knitr::include_graphics("/img/nba.jpeg",error=FALSE)
nba_data<-read_csv(here::here("data","nba.data.historical.csv"))
attach(nba_data)
ts.mod <- lm((TS.+1)~age+pos+X3PAr+FTAr)
par(mfrow=c(2,2))
plot(ts.mod)
```

```{r}
car::boxCox(ts.mod)
```


```{r}
library(car)
car::Anova(ts.mod,type="2")
```

```{r}
trb.mod<-lm((TRB.+1)~age+pos+X3PAr+FTAr)
par(mfrow=c(2,2))
plot(trb.mod)
```
```{r}
car::boxCox(trb.mod)
```


```{r}
library(car)
car::Anova(trb.mod,type="2")
```


# Identify multicollinearity
```{r}
nba_data %>% cor_test(TS., TRB.)
```
# check multivariate normality assumpetion
```{r}
library(tidyverse)
library(ggpubr)
library(rstatix)
library(car)
library(broom)
  nba_data %>%
  select(TS., TRB.) %>%
  mshapiro_test()
```

# check linearity assumption
```{r}
library(GGally)
results <- nba_data %>%
  select(TS.,TRB., pos) %>%
  group_by(pos) %>%
  doo(~ggpairs(.) + theme_bw(), result = "plots")
results
results$plots
```

# fit a multivariate one-way ANOVA model 
```{r}
TS.TRB <- cbind(nba_data$TS.+1, nba_data$TRB.+1)
mod.multi <- lm(TS.TRB~age+pos+X3PAr+FTAr)
class(mod.multi)
summary(mod.multi,test="Wilks")
```

#  use the Anova() function to test the null hypothesis that the two response means are identical

```{r}
manova.multi <- car::Anova(mod.multi, test="Wilks")
manova.multi
```

```{r}
lh.out <- linearHypothesis(mod.multi, hypothesis.matrix = c("age = 0", "FTAr = 0", "X3PAr = 0"))
lh.out
```


```{r}
ggplot(nba_data, aes(x = age, 
                     y = TS., 
                     color=TRB.)) +
  geom_point() +
  labs(title = "TS% and TRB% with age")
```

```{r}
ggplot(nba_data, aes(x = pos, 
                     y = TS., 
                     color=TRB.)) +
  geom_point() +
  labs(title = "TS% and TRB% with pos")
```

```{r}
ggplot(nba_data, aes(x = X3PAr, 
                     y = TS., 
                     color=TRB.)) +
geom_point() +
  labs(
       title = "TS% and TRB% with X3PAr"
       ) 
```


```{r}
ggplot(nba_data, aes(x = FTAr, 
                     y = TS., 
                     color=TRB.)) +
  geom_point()+
  labs(title = "TS% and TRB% with FTAr")
```

```{r}
manova_model <- manova(TS.TRB~age+pos+X3PAr+FTAr)
library(effectsize)
eta_squared(manova_model)
```

```{r}
library(MASS)
nba_lda_age <- lda(age~TS.TRB)
nba_lda_pos <- lda(pos~TS.+TRB.)
nba_lda_X3PAr <- lda(X3PAr~TS.TRB)
nba_lda_FTAr <- lda(FTAr~TS.TRB)
```

```{r}
lda_df_age <- data.frame(
  species = nba_data[, "age"],
  lda = predict(nba_lda_age)$x
)
ggplot(lda_df_age) +
  geom_point(aes(x = lda.LD1, y = lda.LD2, color = age), size = 5) +
  theme_classic()
```

```{r}
lda_df_pos <- data.frame(
  species = nba_data[, "pos"],
  lda = predict(nba_lda_pos)$x
)
ggplot(lda_df_pos) +
  geom_point(aes(x = lda.LD1, y = lda.LD2, color = pos), size = 5) +
  theme_classic()
```

```{r}
lda_df_X3PAr <- data.frame(
  species = nba_data[, "X3PAr"],
  lda = predict(nba_lda_X3PAr)$x
)
ggplot(lda_df_X3PAr) +
  geom_point(aes(x = lda.LD1, y = lda.LD2, color = X3PAr), size = 5) +
  theme_classic()
```

```{r}
lda_df_FTAr <- data.frame(
  species = nba_data[, "FTAr"],
  lda = predict(nba_lda_FTAr)$x
)
ggplot(lda_df_FTAr) +
  geom_point(aes(x = lda.LD1, y = lda.LD2, color = FTAr), size = 5) +
  theme_classic()
```
















